# 작사가 만들기



## 목표

- 인공지능이 문장을 이해하는 방식에 대해 알아본다.
- 시퀀스에 대해 알아본다.



## 시퀀스

-데이터를 순서대로 하나씩 나열하여 나타낸 데이터 구조
-특정 위치(~번째)의 데이터를 가리킬 수 있음

문장도 시퀀스로 볼수 있다. 문장데이터를 이용한 인공지능 만들때는 통계기반 방법 이용



# 연습 

* 텍스트를 읽어와서 데이터의 형태 확인

* 공백, 배우이름 제거 - 대사만 필요하므로

* 정규식이용해서 부호, 특문제거, 작업편하게 모두 소문자화

* <start> 문장<end> 형태로 데이터 생성 

* <start>문장 - 입력, 문장<end>-출력으로 사용

* tf.keras.preprocessing.text.Tokenizer패키지 이용

  (토큰화, 벡터화, 사전화 가능)

* tf.keras.preprocessing.text.Tokenizer를 이용해 corpus를 텐서로 변환

* tf.data.Dataset.from_tensor_slices()를 이용해 corpus 텐서를 tf.data.Dataset객체로 변환

* 임베딩 - RNN -RNN - Dense 구조로 학습

  (return_sequence=True 필수)

* 입력문장에 생성문장을 추가하는 방식으로 문장생성 후 사람이 직접 적절한지 평가 진행



# 실습

*  가사 데이터 읽어옴(약 187000개)
* 위와 동일한 과정을 거쳐 데이터 전처리
* 가사는 너무 길면 이상하므로 단어수 15개 넘는 문장은 제외
* 토큰화, 단어사전 생성(12000)
* 학습
* 평가



# 소감

모델이 문장을 만들어내지만, 사람에 비해선 부족하고 끝나면 안된다 생각한 부분에서 끊기는 현상이 발생했다, 나름 좋은 장비를 사용하고 있는데도 학습에 오랜시간이 걸리고, 한번 끊기면 낭비가 심하다. 데이터가 많으니 좋은 환경에서 장시간 학습을 진행하면 좋은 결과가 나올수 있을까, 요새 종종 사용되는 챗봇을 이렇게 만드는 것인가라는 생각을 해보게 된다. 

